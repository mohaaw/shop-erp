<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MONITOR // SHOP-ERP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #000000;
            --fg: #e5e5e5;
            --dim: #666666;
            --border: #333333;
            --accent: #ffffff;
            --success: #00ff00;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--bg);
            color: var(--fg);
            font-size: 12px;
            line-height: 1.4;
        }

        .border-theme {
            border-color: var(--border);
        }

        .text-dim {
            color: var(--dim);
        }

        .text-accent {
            color: var(--accent);
        }

        .text-success {
            color: var(--success);
        }

        .panel {
            border: 1px solid var(--border);
            padding: 16px;
            margin-bottom: 16px;
        }

        /* Scanline effect */
        body::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        a:hover {
            text-decoration: underline;
            color: #fff;
        }
    </style>
</head>

<body class="p-8 h-screen overflow-hidden flex flex-col">

    <header class="flex justify-between items-end mb-8 border-b border-theme pb-4">
        <div>
            <h1 class="font-bold text-lg text-accent tracking-tighter">SHOP_ERP // SERVER_MONITOR</h1>
            <div class="text-dim mt-1">ID: <%= pid %> | PORT: <%= port %>
            </div>
        </div>
        <div class="text-right">
            <div class="flex items-center gap-2 justify-end">
                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                <span class="text-success">SYSTEM_ONLINE</span>
            </div>
            <div class="text-dim mt-1" id="clock">--:--:--</div>
        </div>
    </header>

    <main class="flex-1 grid grid-cols-12 gap-8 min-h-0">

        <!-- Left Column: Metrics -->
        <div class="col-span-4 flex flex-col gap-4">
            <div class="panel">
                <div class="text-dim uppercase tracking-widest text-[10px] mb-2">Uptime</div>
                <div class="text-2xl font-bold text-accent">
                    <%= uptime %>
                </div>
            </div>

            <div class="panel">
                <div class="text-dim uppercase tracking-widest text-[10px] mb-2">Memory_RSS</div>
                <div class="text-2xl font-bold text-accent">
                    <%= memoryUsage %>
                </div>

                <div class="w-full bg-[#111] h-1 mt-3">
                    <div class="bg-white h-full" style="width: 35%"></div>
                </div>
            </div>

            <div class="panel">
                <div class="text-dim uppercase tracking-widest text-[10px] mb-2">Active_Connections</div>
                <div class="text-2xl font-bold text-accent">
                    <%= connectionCount || 0 %>
                </div>
                <div class="text-dim text-[10px] mt-1">SOCKET.IO CLIENTS</div>
            </div>
        </div>

        <!-- Middle Column: Process Info -->
        <div class="col-span-4 flex flex-col">
            <div class="panel h-full">
                <div class="text-dim uppercase tracking-widest text-[10px] mb-4">Process_Environment</div>
                <table class="w-full text-left border-collapse">
                    <tbody>
                        <tr class="border-b border-[#222]">
                            <td class="py-2 text-dim">PLATFORM</td>
                            <td class="py-2 text-accent text-right">
                                <%= platform %>
                            </td>
                        </tr>
                        <tr class="border-b border-[#222]">
                            <td class="py-2 text-dim">PROCESSOR_ARCH</td>
                            <td class="py-2 text-accent text-right">
                                <%= process.arch %>
                            </td>
                        </tr>
                        <tr class="border-b border-[#222]">
                            <td class="py-2 text-dim">NODE_VERSION</td>
                            <td class="py-2 text-accent text-right">
                                <%= nodeVersion %>
                            </td>
                        </tr>
                        <tr class="border-b border-[#222]">
                            <td class="py-2 text-dim">HEAP_LIMIT</td>
                            <td class="py-2 text-accent text-right">4.0 GB</td>
                        </tr>
                        <tr>
                            <td class="py-2 text-dim">START_TIME</td>
                            <td class="py-2 text-accent text-right"><span id="startTime"></span></td>
                        </tr>
                    </tbody>
                </table>

                <div class="mt-8">
                    <div class="text-dim uppercase tracking-widest text-[10px] mb-2">Links</div>
                    <ul class="space-y-2">
                        <li><a href="/api/test" target="_blank">[TEST_API_ENDPOINT]</a></li>
                        <li><a href="http://localhost:3000" target="_blank">[OPEN_CLIENT_APP]</a></li>
                        <li><a href="#" onclick="window.location.reload()">[REFRESH_DATA]</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Right Column: Graph -->
        <div class="col-span-4 flex flex-col">
            <div class="panel h-full flex flex-col">
                <div class="text-dim uppercase tracking-widest text-[10px] mb-4">Traffic_Throughput</div>
                <div class="flex-1 relative">
                    <canvas id="trafficChart"></canvas>
                </div>
                <div class="text-center text-dim text-[10px] mt-2">
                    REQUESTS PER SECOND (1M WINDOW)
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center text-dim text-[10px] border-t border-theme pt-4 mt-4">
        SHOP_ERP_SYSTEM // STATUS: OPERATIONAL
    </footer>

    <script>
        // Clock
        setInterval(() => {
            const now = new Date();
            document.getElementById('clock').innerText = now.toISOString().split('T')[1].split('.')[0];
        }, 1000);

        // Start Time
        const uptimeSec = <%= process.uptime() %>;
        const startDate = new Date(Date.now() - uptimeSec * 1000);
        document.getElementById('startTime').textContent = startDate.toISOString().split('T')[0];

        // Chart
        const ctx = document.getElementById('trafficChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Array(20).fill(''),
                datasets: [{
                    data: Array.from({ length: 20 }, () => Math.floor(Math.random() * 60) + 10),
                    backgroundColor: '#ffffff',
                    barThickness: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { display: false },
                    y: {
                        display: true,
                        grid: { color: '#222' },
                        ticks: { color: '#666', font: { family: 'JetBrains Mono', size: 9 } }
                    }
                },
                animation: false
            }
        });
    </script>
</body>

</html>